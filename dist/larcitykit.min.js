/*********************** angular-uuid.js ***********************/
function AngularUUID(){"use strict"
function e(e){function n(e,n,t){var r=n&&t||0,o=0
for(n=n||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){o<16&&(n[r+o++]=p[e])});o<16;)n[r+o++]=0
return n}function t(e,n){var t=n||0,r=f
return r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[t++]]}function r(e,n,r){var o=n&&r||0,i=n||[]
e=e||{}
var a=null!=e.clockseq?e.clockseq:y,c=null!=e.msecs?e.msecs:(new Date).getTime(),u=null!=e.nsecs?e.nsecs:w+1,l=c-m+(u-w)/1e4
if(l<0&&null==e.clockseq&&(a=a+1&16383),(l<0||c>m)&&null==e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")
m=c,w=u,y=a,c+=122192928e5
var s=(1e4*(268435455&c)+u)%4294967296
i[o++]=s>>>24&255,i[o++]=s>>>16&255,i[o++]=s>>>8&255,i[o++]=255&s
var d=c/4294967296*1e4&268435455
i[o++]=d>>>8&255,i[o++]=255&d,i[o++]=d>>>24&15|16,i[o++]=d>>>16&255,i[o++]=a>>>8|128,i[o++]=255&a
for(var f=e.node||v,p=0;p<6;p++)i[o+p]=f[p]
return n?n:t(i)}function o(e,n,r){var o=n&&r||0
"string"==typeof e&&(n="binary"===e?new d(16):null,e=null),e=e||{}
var a=e.random||(e.rng||i)()
if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,n)for(var c=0;c<16;c++)n[o+c]=a[c]
return n||t(a)}var i,a,c,u=e.crypto||e.msCrypto
if(!i&&u&&u.getRandomValues)try{var l=new Uint8Array(16)
c=i=function(){return u.getRandomValues(l),l},i()}catch(e){}if(!i){var s=new Array(16)
a=i=function(){for(var e,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),s[n]=e>>>((3&n)<<3)&255
return s},"undefined"!=typeof console&&console.warn&&console.warn("[SECURITY] node-uuid: crypto not usable, falling back to insecure Math.random()")}for(var d="function"==typeof Buffer?Buffer:Array,f=[],p={},h=0;h<256;h++)f[h]=(h+256).toString(16).substr(1),p[f[h]]=h
var g=i(),v=[1|g[0],g[1],g[2],g[3],g[4],g[5]],y=16383&(g[6]<<8|g[7]),m=0,w=0,$=o
return $.v1=r,$.v4=o,$.parse=n,$.unparse=t,$.BufferClass=d,$._rng=i,$._mathRNG=a,$._whatwgRNG=c,$}angular.module("angular-uuid",[]).factory("uuid",["$window",e])}"undefined"!=typeof module&&module.exports?module.exports=new AngularUUID:"undefined"!=typeof define&&define.amd?define(function(){return new AngularUUID}):AngularUUID(),function(){"use strict"
angular.module("http-auth-interceptor",["http-auth-interceptor-buffer"]).factory("authService",["$rootScope","httpBuffer",function(e,n){return{loginConfirmed:function(t,r){var o=r||function(e){return e}
e.$emit("app:auth-loginConfirmed",t),n.retryAll(o)},loginCancelled:function(t,r){n.rejectAll(r),e.$emit("app:auth-loginCancelled",t)}}}]).config(["$httpProvider",function(e){e.interceptors.push(["$rootScope","$q","httpBuffer",function(e,n,t){return{responseError:function(r){if(console.log("Rejection >>"),console.log(r),401===r.status){var o=n.defer()
return t.append(r.config,o),e.$emit("app:auth-loginRequired",r),o.promise}return n.reject(r)}}}])}]),angular.module("http-auth-interceptor-buffer",[]).factory("httpBuffer",["$injector",function(e){function n(n,r){function o(e){r.resolve(e)}function i(e){r.reject(e)}t=t||e.get("$http"),t(n).then(o,i)}var t,r=[]
return{append:function(e,n){r.push({config:e,deferred:n})},rejectAll:function(e){if(e)for(var n=0;n<r.length;++n)r[n].deferred.reject(e)
r=[]},retryAll:function(e){for(var t=0;t<r.length;++t)n(e(r[t].config),r[t].deferred)
r=[]}}}])}(),angular.module("larcity-constants",[]).constant("Constants",{Event:{Auth:{REQUIRED:"app:auth:loginRequired",LOGIN_CONFIRMED:"app:auth:loginConfirmed",LOGIN_CANCELED:"app:auth:loginCanceled"}},Permission:{GEOLOCATION:"permission.geolocation"}})
var LarCity=function(){function e(){var e=this
e.isValidURL=function(e){return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)/.test(e)},e.isValidEmail=function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},e.isNumericKeyCode=function(e,n){return e>=48&&e<=57||e>=96&&e<=105||[107,108,110,8,9,45,46,16,37,38,39,40].indexOf(e)!==-1||190===e&&n.val().split(".").length<2},e.randomString=function(e,n){n||(n="aA#")
var t=""
n.indexOf("a")>-1&&(t+="abcdefghijklmnopqrstuvwxyz"),n.indexOf("A")>-1&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),n.indexOf("#")>-1&&(t+="0123456789"),n.indexOf("!")>-1&&(t+="~`!@#$%^&*()_+-={}[]:\";'<>?,./|\\")
for(var r="",o=e;o>0;--o)r+=t[Math.round(Math.random()*(t.length-1))]
return r},e.getRawParameters=function(e){var n,t,r={}
e?n=e:(t=window.location.href.split("?"),t.length>1&&(n=t[1]))
var t=window.location.href.split("?")
if(void 0!==n)for(var o=n.split("&"),i=0;i<o.length;i++){var a=o[i].split("=")
if(void 0===r[a[0]])r[a[0]]=a[1]
else if("string"==typeof r[a[0]]){var c=[r[a[0]],a[1]]
r[a[0]]=c}else r[a[0]].push(a[1])}return r},String.prototype.toCamelCase=function(){var e=this
return e=[e.charAt(0).toLowerCase(),e.substring(1,e.length)].join("").replace(/[\s\t]+/gi,""),console.log("Camel case: %s",e),e},e.getParameterByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")
var n=new RegExp("[\\?&]"+e+"=([^&#]*)"),t=n.exec(location.search)
return null==t?"":decodeURIComponent(t[1].replace(/\+/g," "))},this.getQueryString=function(e,n){var t=n?n:window.location.href,r=new RegExp("[?&]"+e+"=([^&#]*)","i"),o=r.exec(t)
return o?o[1]:void 0},this.debugMode=function(){return void 0!==this.getQueryString("debug")},this.log=function(){e.debugMode()&&window.console.log.apply(null,arguments)},this.info=function(){e.debugMode()&&window.console.info.apply(null,arguments)},this.warn=function(){e.debugMode()&&window.console.warn.apply(null,arguments)},this.error=function(){window.console.error.apply(null,arguments)},this.init=function(){return e.log("Debug? %s",void 0!==this.getQueryString("debug")),e}}var n=new e
return n.init(),n}()
angular.module("ng-larcity-standalone",[]).provider("$larcity",function(){var e=function(e,n,t){var r=t,o={ToolKit:n,config:function(){return r},log:console.log,info:console.info,error:console.error,warn:console.warn}
return document.addEventListener("com:comenity:ready",function(e){o.ToolKit=e.detail,o.log=o.ToolKit.log,o.info=o.ToolKit.info,o.error=o.ToolKit.error,o.warn=o.ToolKit.warn,o.ToolKit.log("ComenityJS is ready! %o",e.detail)}),o}
if(this.$get=["$rootScope",function(n){return new e(n,null,this.config)}],void 0!==typeof LarCity){var n=new CustomEvent("com:larcity:ready",{detail:LarCity})
document.dispatchEvent(n)}else console.error("larcity.js required, and not loaded!")}),angular.module("lng-services",["service.data","http-auth-interceptor","ng-larcity-standalone","angular-uuid"]).factory("$authService",["$rootScope","$dataService","$instanceStorage","$larcity","$location",function(e,n,t,r,o){console.log("[$authService]"),e.logout=function(){t.set("user",null),t.set("credentials",null),o.path("/login")}
var i={authInfoExists:function(){var e=t.get("credentials")
return null!==e&&e.accessToken},userInfoExists:function(){var e=t.get("user")
return this.authInfoExists()&&null!==e&&e._id},isAuthorized:function(e){return"string"==typeof e&&(e=e.split(" ")),new Promise(function(e,n){return t.get("credentials")?e(!0):n("No credentials found")})},saveCredentialsFromHTTPResponse:function(e){return new Promise(function(r,o){return console.warn("Authentication response @ $authService -> %o",e),e.data&&e.data.credentials?(t.set("user",e.data),t.set("credentials",e.data.credentials),n.set("User",e.data),n.set("credentials",e.data.credentials),r(e.data.credentials)):o("Owner or Credentials missing in auth response")})}}
return e.authHelper=i,i}]).run(["$rootScope","$larcity","$instanceStorage","$location",function(e,n,t,r){var o=function(){return new Promise(function(n,o){var i=r.search()
i&&i.accessToken&&("timeCreated,expiresInSeconds".split(",").forEach(function(e){i[e]&&(i[e]=parseInt(i[e]))}),console.warn("Credentials -> %o",i),t.set("credentials",i),r.url(r.path("/tests")),e.$$phase||e.$apply())})}
document.addEventListener("com:larcity:ready",function(){o()})}]).factory("$accessShieldService",["$rootScope","$authService","$location",function(e,n,t){console.log("[$accessShieldService]")
var r={requireAuthorization:function(e){n.isAuthorized(e||["view"]).then(function(){console.info("Authorized")}).catch(function(e){console.error("Not authorized: %s",e),t.path("/login")})}}
return r.requireAuthorization(),r}]).factory("$demoShield",function(e){return e}).factory("$dependencyManager",["$rootScope","uuid","$timeout",function(e,n,t){return e.$on("$routeChangeStart",function(){document.querySelectorAll(".dependency").forEach(function(e){e.parentNode&&(console.warn("Removing: %s",e.href||e.src||e.id),e.parentNode.removeChild(e))})}),e.$on("$routeChangeSuccess",function(){t(function(){document.querySelectorAll(".ng-hide.has-dependency").forEach(function(e){angular.element(e).removeClass("ng-hide")})},500,!0)}),{require:function(e){if(!Array.isArray(e))return console.error("The require library ONLY accepts an array of style of js dependencies")
angular.forEach(e,function(e){var t,r
if(e&&"string"!=typeof e&&"object"==typeof e?(t=e.onload,r=e.src||e.href,t&&console.warn(">>> Will run callback after loading: %s <<<",e.src)):r=e,/\.js$/.test(r)){var o=document.createElement("script")
o.type="text/javascript",o.id=n.v4(),o.src=r,o.className="js dependency",o.onload=function(){var e=this,n=new CustomEvent("script:loaded")
console.warn("Loaded: %s",e.src),e.dispatchEvent(n),"function"==typeof t&&t()},document.querySelector("head").appendChild(o)}else if(/\.css$/.test(r)){var i=document.createElement("link")
i.rel="stylesheet",i.id=n.v4(),i.href=r,i.className="style dependency",i.onload=function(){var e=this,n=new CustomEvent("style:loaded")
console.warn("Loaded: %s",e.href),e.dispatchEvent(n),"function"==typeof t&&t()},document.querySelector("head").appendChild(i)}})}}}])
